addpath(genpath('helper_functions'));
clearvars; hold on; close all;

fs = 15000;
dftsize = 512;
window = ones(dftsize, 1);  % Rectangular window
% ??????????????????????????? MOET WINDOW WEL ??????????????????????????
% ??????????????????? WAAROM OVERLAP ???????????????????????????
noverlap = 0;                   % N samples to overlap between segments



noise = 
[simin,nbsecs,fs] = initparams(sig,fs);
sim('recplay');
rec=simout.signals.values;




[sig_fft, df_sig, t_sig, psd_sig] = spectrogram(sig, window, noverlap, dftsize, fs);
psd_sig_avg = mean(psd_sig, 2)';


[rec_fft, df_rec, t_rec, psd_rec] = spectrogram(rec, window, noverlap, dftsize, fs);
psd_rec_avg = mean(psd_rec, 2)';



sig = wgn(fs*3,1,0); %White noise
% ??? should be NOT WHITE


c_chan = 0;
N = dftsize/2;
for k = 1:N
    ps = p_signal[k];
    pn = p_noise[k];
    c_chan = c_chan + fs/(2*N)*log2(1+ps/pn);
end

